var ImageFeedUtils;(function(n){function e(){return"".concat(f).concat(w).concat(b).concat(k)}function o(n){while(n&&!n.classList.contains(t.ImageItemWrapperClass))n=n.parentElement;return n}function a(n){var t;if((t=v(n))!==null&&t!==void 0)return t.getAttribute("m")}function v(n){if(n!==null&&n!==void 0)return n.querySelector(".iusc")}function d(){return i.form}function g(t){var i,r;return!t||t.length===0?t:(i=n.currentForm(),!i||i.length===0)?t:(r=/([?&][Ff][Oo][Rr][Mm]=)[^&]*/,r.test(t)?t.replace(r,"$1"+i):t+(t.indexOf("?")===-1?"?":"&")+"form="+i)}function nt(n){var t=null,i=[];return(n=o(n),!n)?i:(t=a(n),t&&i.push(t),i)}function tt(){var e={ck:"id"},u=null,o=_ge(t.DetailPageMainImageWindowId),f=[],n={},r,s;if(!o)return[];if(u=o.getAttribute("data-m"),u!=null)try{n=JSON.parse(u)}catch(h){return f}for(r in e)i.hasOwnProperty(r)&&(s=e[r],n[s]=i[r]);return n&&f.push(JSON.stringify(n)),f}function it(n){var t="",i;return n=o(n),n&&n.parentElement&&(i=n.parentElement.classList,i.contains("fdsimf")?t="ssi":i.contains("clst-rndrd")&&(t="clstr")),t?"&imgType="+t:""}function y(n,i,r){var h,u,s,o;if((!f||l)&&(i.length>0||t.EmptyPayloadEvents.indexOf(n)!==-1)){if(n===t.SeenEvent&&typeof mmLog=="function"&&mmLog('{"T":"CI.Seen","Name":"FeedPage","Count":'+i.length+',"TS":'+sb_gt()+"}"),h=it(r),u=sj_gx(),typeof sj_cook=="undefined")return;s="SID";o=sj_cook.get("_SS",s)||sj_cook.get(s,s);h+=o?"&sid=".concat(o):"";u.open("POST","/images/feed/feedback?IG=".concat(_G.IG,"&IID=FEEDBACK&SFX=").concat(t.sfx++,"&event=").concat(n).concat(e()).concat(h),!0);o&&u.setRequestHeader("f-sid",o);u.setRequestHeader("Content-type","application/json");n===t.FreClickFeedbackEvent&&(u.onreadystatechange=function(){u.status==200&&u.readyState==4&&(sb_st(function(){sj_evt.fire(t.FreClickFeedbackSuccessEvent)},3e3),sb_st(function(){var n=_qs(".expandButton",_d);n.classList.remove("active");n.classList.add("frcldng","loading")},2e3))});u.timeout=t.Xhr_TimeOut;u.send("[".concat(i.join(","),"]"));(n=="Like"||n=="save")&&sj_evt.fire("fetchSimilarImages",i[0],r,n)}}function rt(n){var t;try{t=JSON.parse(n)}catch(i){return null}return t}function ut(n){var i=_ge(t.ImageFeedContainerId),r=i===null||i===void 0?void 0:i.getAttribute(t.FeedRefreshUrlAttribute);u(n,r)}function u(n,i,r,f){var s,h,o;(r===void 0&&(r=null),f===void 0&&(f=0),s=_ge(t.ImageFeedContainerId),!s||f>=t.MaxRetryCount)||(h=i,h)&&(f++,o=sj_gx(),o.open("get","".concat(h,"&IG=").concat(_G.IG,"&SFX=").concat(t.sfx++).concat(e()),!0),o.onreadystatechange=function(){o.status==200&&o.readyState==4&&(s.textContent="",o.responseText&&sj_appHTML(s,o.responseText),_qs(t.DenseGridContainerSelector,s)?sj_evt.fire("Feed.Refresh"):(y(n,[]),u(n,i,r,f)),r===null||r===void 0?void 0:r(o.responseText))},o.onerror=function(){u(n,i,r,f)},o.timeout=t.Xhr_TimeOut,o.send())}var r=typeof pMMUtils!="undefined"?pMMUtils:null,t=FeedConstants,i=parseQueryParams(),s=i?i.fbflight:i,h=i?i.sf:i,c=i?i.recoflight:i,w=s?"&fbflight=".concat(s):"",f="",l=!1,b=h?"&sf=".concat(h):"",k=c?"&recoflight=".concat(c):"",p;_ge(t.DebugElementId)&&i&&(f=i.anid?"&testhooks=1&isuserauth=1&anid=".concat(i.anid):"",l=i.fbh=="1");n.getOverrideQueryParams=e;n.getImageItemWrapper=o;n.getMetaData=a;n.getElementWithMetadata=v;n.currentForm=d;n.urlWithCurrentForm=g;n.processElement=nt;n.processDetailPageMainElement=tt;n.processRequest=y;n.tryParseJson=rt;n.refreshWithRetry=ut;n.refreshWithUrl=u;n.convertTopicNameToURLPath=function(n){var t=n.trim().toLowerCase().replace(/'/g,"").replace(/\s+/g,"-").replace(/[^a-z0-9\-]/g,"").replace(/-+/g,"-").replace(/^-+|-+$/g,"");return encodeURIComponent(t)};p=function(){var n=document.referrer,t,i;return!n||n.length===0?!1:(t=n.indexOf("bing.com")>-1,i=n.indexOf("bing-int.com")>-1,t||i)};n.close=function(){var n,u=(n=r===null||r===void 0?void 0:r.qsv)===null||n===void 0?void 0:n.call(r,t.BackUrlName),f;u?window.location.href=u:p()?history.length>1?history.back():window.close():(f=i.form||"IRPFED",window.location.href="/images/feed?FORM=".concat(f))}})(ImageFeedUtils||(ImageFeedUtils={}))